# 43721 - 最大距离

![Year: 2020](https://img.shields.io/badge/Year-2020-white)
![Level: Provincial Mock](https://img.shields.io/badge/Level-Provincial%20Mock-blue)
![Python3](https://img.shields.io/badge/Python3-AC-green)

## 题目

### 题目描述

在数列 $a_1, a_2, \cdots, a_n$ 中，定义两个元素 $a_i$ 和 $a_j$ 的距离为 $|i-j|+|a_i-a_j|$ ，即元素下标的距离加上元素值的差的绝对值，其中 $|x|$ 表示 $x$ 的绝对值。

给定一个数列，请问找出元素之间最大的元素距离。

### 输入描述

输入的第一行包含一个整数 $n$ 。

第二行包含 $n$ 个整数 $a_1, a_2, \cdots, a_n$ ，相邻的整数间用空格分隔，表示给定的数列。

其中， $2 \leq n \leq 1000$ ， $0 \leq 数列中的数 \leq 10^4$ 。

### 输出描述

输出一行包含一个整数，表示答案。

### 输入输出样例

#### 示例

> 输入

```txt
5
9 4 2 4 7
```

> 输出

```txt
9
```

## 分析

本题求解的是最大曼哈顿距离。

几何平面上，对于点 $A(x_1, y_1)$ 和点 $B(x_2, y_2)$ ，它们的曼哈顿距离是横纵坐标之差的绝对值之和，即 $d(A,B) := |x_1-x_2|+|y_1-y_2|$ 。

最简单的做法是遍历所有可能的 $A,B$ 两点的组合（一共有 $C_n^2$ 种），求出它们的曼哈顿距离，然后找出最大值即可。这样做的时间复杂度是 $O(n^2)$ 。

### 优化

由于本题的输入范围较小，以上暴力算法是可行的。但是如果输入更大的话，就需要使用数学方法来进行优化了。

> 引理： 
> ```math
> |\alpha|+|\beta| = \max\{\alpha+\beta, -\alpha+\beta, -\alpha-\beta, \alpha-\beta\}
>```

根据引理，我们可以将曼哈顿距离改写为：

```math
d(A, B) = |x_1-x_2|+|y_1-y_2| \\
= \max\{(x_1-x_2)+(y_1-y_2), (-x_1+x_2)+(y_1-y_2), (-x_1+x_2)+(-y_1+y_2), (x_1-x_2)+(-y_1+y_2)\} \\
= \max\{(x_1+y_1)-(x_2+y_2), (-x_1+y_1)-(-x_2+y_2), (-x_1-y_1)-(-x_2-y_2), (x_1-y_1)-(x_2-y_2)\}
```

于是只需要为一系列的点 $P(x, y)$ 计算以下四种表达式：

```math
s_1 := x+y, \quad s_2 := -x+y \\
s_3 := -x-y, \quad s_4 := x-y
```

求得所有点的上述四种表达式，分别归入数列 $S_1, S_2, S_3,S_4$ ，然后找到每种表达式的最大差值（用最大值减最小值即可）：

```math
\Delta_1 := \max S_1 - \min S_1, \quad \Delta_2 := \max S_2 - \min S_2 \\
\Delta_3 := \max S_3 - \min S_3, \quad \Delta_4 := \max S_4 - \min S_4
```

此时即可求得最大曼哈顿距离：

```math
d_{\max} = \max\{\Delta_1, \Delta_2, \Delta_3, \Delta_4\}
```

实际编码时，我们只需要生成 $S_1, S_2, S_3, S_4$ 的列表，然后再做一些简单运算就能得到答案。这样做的时间复杂度是 $O(n)$ ，显著优于第一种方法。
